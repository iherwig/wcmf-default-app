sudo: false

language: php

php:
  - 5.4
  - 5.5
  - 5.6

before_install:
  - "sudo apt-get purge openjdk*"
  - "sudo apt-get clean"
  - "sudo apt-get autoremove"
  - "sudo add-apt-repository -y ppa:webupd8team/java"
  - "sudo apt-get update"

install:
  - "sudo apt-get install oracle-java8-installer"
  - "sudo update-java-alternatives -s java-8-oracle"
  - "export JAVA_HOME=/usr/lib/jvm/java-8-oracle"
    
env:
  - TEST_DIR=$TRAVIS_BUILD_DIR/test WCMF_BASE_DIR=$TRAVIS_BUILD_DIR

before_script:
  - "sh -e /etc/init.d/xvfb start"
  - "export DISPLAY=:99.0"
  - "wget http://selenium-release.storage.googleapis.com/2.46/selenium-server-standalone-2.46.0.jar"
  - "java -jar selenium-server-standalone-2.46.0.jar &"
  - sleep 5

  - composer self-update
  - composer install

  - cd $WCMF_BASE_DIR/build && ant generate && ant dist

script:
  - cd $TEST_DIR && phpunit --bootstrap bootstrap.php -c configuration.xml
